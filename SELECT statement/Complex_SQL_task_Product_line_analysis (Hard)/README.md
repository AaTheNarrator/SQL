## Задание: Анализ продаж сегментов товаров с использованием оконных функций

У вас есть база данных с информацией о продажах в вашей компании, которая включает в себя таблицу "sales" со следующими столбцами: "product_id" (идентификатор продукта), "sale_date" (дата продажи), "amount" (количество проданных единиц).

Ваша задача:

1. Разделить продукты на два сегмента: "популярные" и "непопулярные". Продукт считается "популярным", если его средний объем продажи (сумма продажи) за последние 6 месяцев составляет более 1000 единиц.

2. Для каждого "популярного" продукта определить количество дней, в течение которых продажи превышали 100 единиц в месяц, и средний объем продажи в эти дни.

3. Для каждого "непопулярного" продукта определить количество дней, в течение которых продажи превышали 10 единиц в месяц, и средний объем продажи в эти дни.

Вывести результаты в виде таблицы с колонками:
- "product_id" (идентификатор продукта)
- "segment" (сегмент продукта: "популярный" или "непопулярный")
- "date" (год и месяц за который береться статистика)
- "days_above_threshold" (количество дней с продажами выше порога)
- "average_sales" (средний объем продажи в дни с продажами выше порога).
